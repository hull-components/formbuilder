this.Hull=this.Hull||{},this.Hull.templates=this.Hull.templates||{},this.Hull.templates._default=this.Hull.templates._default||{},Hull.templates._default["form/fields/checkboxes"]=function(a,e,n,t,l){function i(a,e,t){var l,i,s="";return s+="\n<div>\n  <label class='fb-option'>\n    <input type='checkbox' name=\""+f((l=t&&t.name,typeof l===d?l.apply(a):l))+'[]" value="',(i=n.label)?l=i.call(a,{hash:{},data:e}):(i=a&&a.label,l=typeof i===d?i.call(a,{hash:{},data:e}):i),s+=f(l)+'" ',l=n["if"].call(a,a&&a.selected,{hash:{},inverse:c.noop,fn:c.program(2,o,e),data:e}),(l||0===l)&&(s+=l),s+=" ",l=n["if"].call(a,a&&a.required,{hash:{},inverse:c.noop,fn:c.program(4,r,e),data:e}),(l||0===l)&&(s+=l),s+=" />\n    ",(i=n.label)?l=i.call(a,{hash:{},data:e}):(i=a&&a.label,l=typeof i===d?i.call(a,{hash:{},data:e}):i),s+=f(l)+"\n  </label>\n</div>\n"}function o(){return"checked"}function r(){return'data-parsley-maxcheck="1"'}function s(a,e){var t,l,i="";return i+="\n<div class='other-option'>\n  <label class='fb-option'>\n    <input type='checkbox' name=\"",(l=n.name)?t=l.call(a,{hash:{},data:e}):(l=a&&a.name,t=typeof l===d?l.call(a,{hash:{},data:e}):l),i+=f(t)+'[]" value="other" ',t=n["if"].call(a,a&&a.other_value,{hash:{},inverse:c.noop,fn:c.program(2,o,e),data:e}),(t||0===t)&&(i+=t),i+=" />\n    Other\n  </label>\n\n  <input type='text' name=\"",(l=n.name)?t=l.call(a,{hash:{},data:e}):(l=a&&a.name,t=typeof l===d?l.call(a,{hash:{},data:e}):l),i+=f(t)+'_other_value" value="',(l=n.other_value)?t=l.call(a,{hash:{},data:e}):(l=a&&a.other_value,t=typeof l===d?l.call(a,{hash:{},data:e}):l),i+=f(t)+'" />\n</div>\n'}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,a.helpers),l=l||{};var h,p="",d="function",f=this.escapeExpression,c=this;return h=n.each.call(e,(h=e&&e.field_options,null==h||h===!1?h:h.options),{hash:{},inverse:c.noop,fn:c.programWithDepth(1,i,l,e),data:l}),(h||0===h)&&(p+=h),p+="\n\n",h=n["if"].call(e,(h=e&&e.field_options,null==h||h===!1?h:h.include_other_option),{hash:{},inverse:c.noop,fn:c.program(6,s,l),data:l}),(h||0===h)&&(p+=h),p},Hull.templates._default["form/fields/date"]=function(a,e,n,t,l){function i(){return"required"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,a.helpers),l=l||{};var o,r,s,h="",p="function",d=this.escapeExpression,f=this,c=n.blockHelperMissing;return h+='<input id="',(r=n.input_id)?o=r.call(e,{hash:{},data:l}):(r=e&&e.input_id,o=typeof r===p?r.call(e,{hash:{},data:l}):r),h+=d(o)+"\" type='text' name='",(r=n.name)?o=r.call(e,{hash:{},data:l}):(r=e&&e.name,o=typeof r===p?r.call(e,{hash:{},data:l}):r),h+=d(o)+"' class='form-control' \n  ",s={hash:{},inverse:f.noop,fn:f.program(1,i,l),data:l},(r=n.required)?o=r.call(e,s):(r=e&&e.required,o=typeof r===p?r.call(e,s):r),n.required||(o=c.call(e,o,{hash:{},inverse:f.noop,fn:f.program(1,i,l),data:l})),(o||0===o)&&(h+=o),h+=' \n  value="',(r=n.value)?o=r.call(e,{hash:{},data:l}):(r=e&&e.value,o=typeof r===p?r.call(e,{hash:{},data:l}):r),h+=d(o)+'"\n/>'},Hull.templates._default["form/fields/dropdown"]=function(a,e,n,t,l){function i(){return"\n    <option value=''></option>\n  "}function o(a,e){var t,l,i="";return i+='\n    <option value="',(l=n.label)?t=l.call(a,{hash:{},data:e}):(l=a&&a.label,t=typeof l===d?l.call(a,{hash:{},data:e}):l),i+=f(t)+'" ',t=n["if"].call(a,a&&a.selected,{hash:{},inverse:c.noop,fn:c.program(4,r,e),data:e}),(t||0===t)&&(i+=t),i+=">\n      ",(l=n.label)?t=l.call(a,{hash:{},data:e}):(l=a&&a.label,t=typeof l===d?l.call(a,{hash:{},data:e}):l),i+=f(t)+"\n    </option>\n  "}function r(){return"selected"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,a.helpers),l=l||{};var s,h,p="",d="function",f=this.escapeExpression,c=this;return p+='<select name="',(h=n.name)?s=h.call(e,{hash:{},data:l}):(h=e&&e.name,s=typeof h===d?h.call(e,{hash:{},data:l}):h),p+=f(s)+'" class="form-control">\n  ',s=n["if"].call(e,(s=e&&e.field_options,null==s||s===!1?s:s.include_blank_option),{hash:{},inverse:c.noop,fn:c.program(1,i,l),data:l}),(s||0===s)&&(p+=s),p+="\n  ",s=n.each.call(e,(s=e&&e.field_options,null==s||s===!1?s:s.options),{hash:{},inverse:c.noop,fn:c.program(3,o,l),data:l}),(s||0===s)&&(p+=s),p+="\n</select>\n"},Hull.templates._default["form/fields/email"]=function(a,e,n,t,l){function i(){return"required"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,a.helpers),l=l||{};var o,r,s,h="",p="function",d=this.escapeExpression,f=this,c=n.blockHelperMissing;return h+='<input  id="',(r=n.input_id)?o=r.call(e,{hash:{},data:l}):(r=e&&e.input_id,o=typeof r===p?r.call(e,{hash:{},data:l}):r),h+=d(o)+"\" type='email' name='",(r=n.name)?o=r.call(e,{hash:{},data:l}):(r=e&&e.name,o=typeof r===p?r.call(e,{hash:{},data:l}):r),h+=d(o)+'\' class="form-control"\n  ',s={hash:{},inverse:f.noop,fn:f.program(1,i,l),data:l},(r=n.required)?o=r.call(e,s):(r=e&&e.required,o=typeof r===p?r.call(e,s):r),n.required||(o=c.call(e,o,{hash:{},inverse:f.noop,fn:f.program(1,i,l),data:l})),(o||0===o)&&(h+=o),h+=' \n  data-parsley-trigger="change"\n  value="',(r=n.value)?o=r.call(e,{hash:{},data:l}):(r=e&&e.value,o=typeof r===p?r.call(e,{hash:{},data:l}):r),h+=d(o)+'" \n  placeholder="'+d((o=e&&e.field_options,o=null==o||o===!1?o:o.placeholder,typeof o===p?o.apply(e):o))+'"\n/>'},Hull.templates._default["form/fields/number"]=function(a,e,n,t,l){function i(a){var e,n="";return n+='min="'+c((e=a&&a.field_options,e=null==e||e===!1?e:e.min,typeof e===f?e.apply(a):e))+'"'}function o(a){var e,n="";return n+='max="'+c((e=a&&a.field_options,e=null==e||e===!1?e:e.max,typeof e===f?e.apply(a):e))+'"'}function r(){return'data-parsley-type="integer"'}function s(a){var e,n="";return n+='\n    <span class="add-on input-group-addon">'+c((e=a&&a.field_options,e=null==e||e===!1?e:e.units,typeof e===f?e.apply(a):e))+"</span>\n  "}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,a.helpers),l=l||{};var h,p,d="",f="function",c=this.escapeExpression,u=this;return d+='<span class="input-group input-append">\n\n  <input type=\'text\' name="',(p=n.name)?h=p.call(e,{hash:{},data:l}):(p=e&&e.name,h=typeof p===f?p.call(e,{hash:{},data:l}):p),d+=c(h)+'" value="',(p=n.value)?h=p.call(e,{hash:{},data:l}):(p=e&&e.value,h=typeof p===f?p.call(e,{hash:{},data:l}):p),d+=c(h)+'"  class="form-control"\n    ',h=n["if"].call(e,(h=e&&e.field_options,null==h||h===!1?h:h.min),{hash:{},inverse:u.noop,fn:u.program(1,i,l),data:l}),(h||0===h)&&(d+=h),d+=" \n    ",h=n["if"].call(e,(h=e&&e.field_options,null==h||h===!1?h:h.max),{hash:{},inverse:u.noop,fn:u.program(3,o,l),data:l}),(h||0===h)&&(d+=h),d+=" \n    ",h=n["if"].call(e,(h=e&&e.field_options,null==h||h===!1?h:h.integer_only),{hash:{},inverse:u.noop,fn:u.program(5,r,l),data:l}),(h||0===h)&&(d+=h),d+='\n    data-parsley-trigger="change"\n    data-parsley-errors-container="#parsley-errors-',(p=n.input_id)?h=p.call(e,{hash:{},data:l}):(p=e&&e.input_id,h=typeof p===f?p.call(e,{hash:{},data:l}):p),d+=c(h)+'"\n  /> \n  ',h=n["if"].call(e,(h=e&&e.field_options,null==h||h===!1?h:h.units),{hash:{},inverse:u.noop,fn:u.program(7,s,l),data:l}),(h||0===h)&&(d+=h),d+='\n</span>\n\n<span id="parsley-errors-',(p=n.input_id)?h=p.call(e,{hash:{},data:l}):(p=e&&e.input_id,h=typeof p===f?p.call(e,{hash:{},data:l}):p),d+=c(h)+'"></span>\n'},Hull.templates._default["form/fields/paragraph"]=function(a,e,n,t,l){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,a.helpers),l=l||{};var i,o,r="",s="function",h=this.escapeExpression;return r+='<textarea  id="',(o=n.input_id)?i=o.call(e,{hash:{},data:l}):(o=e&&e.input_id,i=typeof o===s?o.call(e,{hash:{},data:l}):o),r+=h(i)+'" name="',(o=n.name)?i=o.call(e,{hash:{},data:l}):(o=e&&e.name,i=typeof o===s?o.call(e,{hash:{},data:l}):o),r+=h(i)+'" class="form-control">',(o=n.value)?i=o.call(e,{hash:{},data:l}):(o=e&&e.value,i=typeof o===s?o.call(e,{hash:{},data:l}):o),r+=h(i)+"</textarea>"},Hull.templates._default["form/fields/radio"]=function(a,e,n,t,l){function i(a,e,t){var l,i,r="";return r+="\n<div>\n  <label class='fb-option'>\n    <input type='radio' name=\""+d((l=t&&t.name,typeof l===p?l.apply(a):l))+'" value="',(i=n.label)?l=i.call(a,{hash:{},data:e}):(i=a&&a.label,l=typeof i===p?i.call(a,{hash:{},data:e}):i),r+=d(l)+'" ',l=n["if"].call(a,a&&a.selected,{hash:{},inverse:f.noop,fn:f.program(2,o,e),data:e}),(l||0===l)&&(r+=l),r+=" />\n    ",(i=n.label)?l=i.call(a,{hash:{},data:e}):(i=a&&a.label,l=typeof i===p?i.call(a,{hash:{},data:e}):i),r+=d(l)+"\n  </label>\n</div>\n"}function o(){return"checked"}function r(a,e){var t,l,i,r="";return r+="\n<div class='other-option'>\n  <label class='fb-option'>\n    <input type='radio' name=\"",(l=n.name)?t=l.call(a,{hash:{},data:e}):(l=a&&a.name,t=typeof l===p?l.call(a,{hash:{},data:e}):l),r+=d(t)+'" value="other" ',l=n.ifEqual||a&&a.ifEqual,i={hash:{},inverse:f.noop,fn:f.program(2,o,e),data:e},t=l?l.call(a,a&&a.value,"other",i):c.call(a,"ifEqual",a&&a.value,"other",i),(t||0===t)&&(r+=t),r+=" />\n    Other\n  </label>\n\n  <input type='text' name=\"",(l=n.name)?t=l.call(a,{hash:{},data:e}):(l=a&&a.name,t=typeof l===p?l.call(a,{hash:{},data:e}):l),r+=d(t)+'_other_value" value="',(l=n.other_value)?t=l.call(a,{hash:{},data:e}):(l=a&&a.other_value,t=typeof l===p?l.call(a,{hash:{},data:e}):l),r+=d(t)+'" />\n</div>\n'}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,a.helpers),l=l||{};var s,h="",p="function",d=this.escapeExpression,f=this,c=n.helperMissing;return s=n.each.call(e,(s=e&&e.field_options,null==s||s===!1?s:s.options),{hash:{},inverse:f.noop,fn:f.programWithDepth(1,i,l,e),data:l}),(s||0===s)&&(h+=s),h+="\n\n",s=n["if"].call(e,(s=e&&e.field_options,null==s||s===!1?s:s.include_other_option),{hash:{},inverse:f.noop,fn:f.program(4,r,l),data:l}),(s||0===s)&&(h+=s),h+="\n\n"},Hull.templates._default["form/fields/text"]=function(a,e,n,t,l){function i(){return"required"}function o(a){var e,n="";return n+='data-parsley-minlength="'+c((e=a&&a.field_options,e=null==e||e===!1?e:e.minlength,typeof e===f?e.apply(a):e))+'"'}function r(a){var e,n="";return n+='data-parsley-maxlength="'+c((e=a&&a.field_options,e=null==e||e===!1?e:e.maxlength,typeof e===f?e.apply(a):e))+'"'}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,a.helpers),l=l||{};var s,h,p,d="",f="function",c=this.escapeExpression,u=this,m=n.blockHelperMissing;return d+='<input id="',(h=n.input_id)?s=h.call(e,{hash:{},data:l}):(h=e&&e.input_id,s=typeof h===f?h.call(e,{hash:{},data:l}):h),d+=c(s)+"\" type='text' name='",(h=n.name)?s=h.call(e,{hash:{},data:l}):(h=e&&e.name,s=typeof h===f?h.call(e,{hash:{},data:l}):h),d+=c(s)+"' class='form-control' \n  ",p={hash:{},inverse:u.noop,fn:u.program(1,i,l),data:l},(h=n.required)?s=h.call(e,p):(h=e&&e.required,s=typeof h===f?h.call(e,p):h),n.required||(s=m.call(e,s,{hash:{},inverse:u.noop,fn:u.program(1,i,l),data:l})),(s||0===s)&&(d+=s),d+=' \n  value="',(h=n.value)?s=h.call(e,{hash:{},data:l}):(h=e&&e.value,s=typeof h===f?h.call(e,{hash:{},data:l}):h),d+=c(s)+'"\n  ',s=n["if"].call(e,(s=e&&e.field_options,null==s||s===!1?s:s.minlength),{hash:{},inverse:u.noop,fn:u.program(3,o,l),data:l}),(s||0===s)&&(d+=s),d+=" \n  ",s=n["if"].call(e,(s=e&&e.field_options,null==s||s===!1?s:s.maxlength),{hash:{},inverse:u.noop,fn:u.program(5,r,l),data:l}),(s||0===s)&&(d+=s),d+=" \n/>"},Hull.templates._default["form/fields/website"]=function(a,e,n,t,l){function i(){return"required"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,a.helpers),l=l||{};var o,r,s,h="",p="function",d=this.escapeExpression,f=this,c=n.blockHelperMissing;return h+='<input  id="',(r=n.input_id)?o=r.call(e,{hash:{},data:l}):(r=e&&e.input_id,o=typeof r===p?r.call(e,{hash:{},data:l}):r),h+=d(o)+"\" type='url' name='",(r=n.name)?o=r.call(e,{hash:{},data:l}):(r=e&&e.name,o=typeof r===p?r.call(e,{hash:{},data:l}):r),h+=d(o)+'\' class="form-control" ',s={hash:{},inverse:f.noop,fn:f.program(1,i,l),data:l},(r=n.required)?o=r.call(e,s):(r=e&&e.required,o=typeof r===p?r.call(e,s):r),n.required||(o=c.call(e,o,{hash:{},inverse:f.noop,fn:f.program(1,i,l),data:l})),(o||0===o)&&(h+=o),h+=' value="',(r=n.value)?o=r.call(e,{hash:{},data:l}):(r=e&&e.value,o=typeof r===p?r.call(e,{hash:{},data:l}):r),h+=d(o)+'" placeholder="http://"/>'},Hull.templates._default["form/main"]=function(a,e,n,t,l){function i(a,e){var t,l,i="";return i+="\n  <h1>",(l=n.name)?t=l.call(a,{hash:{},data:e}):(l=a&&a.name,t=typeof l===y?l.call(a,{hash:{},data:e}):l),i+=g(t)+"</h1>\n  <p>",(l=n.description)?t=l.call(a,{hash:{},data:e}):(l=a&&a.description,t=typeof l===y?l.call(a,{hash:{},data:e}):l),i+=g(t)+"</p>\n  "}function o(a,e){var t,l,i,o="";return o+='\n    <div class="',l=n.ifEqual||a&&a.ifEqual,i={hash:{},inverse:_.program(6,s,e),fn:_.program(4,r,e),data:e},t=l?l.call(a,a&&a.field_type,"checkboxes",i):b.call(a,"ifEqual",a&&a.field_type,"checkboxes",i),(t||0===t)&&(o+=t),o+='" data-hull-field-name="',(l=n.name)?t=l.call(a,{hash:{},data:e}):(l=a&&a.name,t=typeof l===y?l.call(a,{hash:{},data:e}):l),o+=g(t)+'">\n      <label for="',(l=n.input_id)?t=l.call(a,{hash:{},data:e}):(l=a&&a.input_id,t=typeof l===y?l.call(a,{hash:{},data:e}):l),o+=g(t)+'">\n        ',(l=n.label)?t=l.call(a,{hash:{},data:e}):(l=a&&a.label,t=typeof l===y?l.call(a,{hash:{},data:e}):l),o+=g(t),t=n["if"].call(a,a&&a.required,{hash:{},inverse:_.noop,fn:_.program(8,h,e),data:e}),(t||0===t)&&(o+=t),o+="\n      </label>\n      ",(l=n.markup)?t=l.call(a,{hash:{},data:e}):(l=a&&a.markup,t=typeof l===y?l.call(a,{hash:{},data:e}):l),(t||0===t)&&(o+=t),o+="\n      ",t=n["if"].call(a,(t=a&&a.field_options,null==t||t===!1?t:t.description),{hash:{},inverse:_.noop,fn:_.program(10,p,e),data:e}),(t||0===t)&&(o+=t),o+="\n    </div>\n  "}function r(){return"checkkbox"}function s(){return"form-group"}function h(){return"*"}function p(a){var e,n="";return n+='\n      <p class="help-block">'+g((e=a&&a.field_options,e=null==e||e===!1?e:e.description,typeof e===y?e.apply(a):e))+"</p>\n      "}function d(){return'\n    <a href="#" class="btn pull-right" data-hull-action="edit">Edit Fields</a>\n    '}function f(){return'\n    <button class="btn btn-danger" data-hull-action="reset">Reset</button>\n    '}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,a.helpers),l=l||{};var c,u,m,v="",y="function",g=this.escapeExpression,_=this,b=n.helperMissing,x=n.blockHelperMissing;return v+='<form role="form" data-hull-form-namespace="',(u=n.formNamespace)?c=u.call(e,{hash:{},data:l}):(u=e&&e.formNamespace,c=typeof u===y?u.call(e,{hash:{},data:l}):u),v+=g(c)+'">\n  ',m={hash:{},inverse:_.noop,fn:_.program(1,i,l),data:l},(u=n.form)?c=u.call(e,m):(u=e&&e.form,c=typeof u===y?u.call(e,m):u),n.form||(c=x.call(e,c,{hash:{},inverse:_.noop,fn:_.program(1,i,l),data:l})),(c||0===c)&&(v+=c),v+="\n\n  ",c=n.each.call(e,e&&e.fields,{hash:{},inverse:_.noop,fn:_.program(3,o,l),data:l}),(c||0===c)&&(v+=c),v+="\n\n  <div>\n    ",c=n["if"].call(e,e&&e.isAdmin,{hash:{},inverse:_.noop,fn:_.program(12,d,l),data:l}),(c||0===c)&&(v+=c),v+='\n\n    <button class="btn btn-primary" type="submit" >Save</button>\n    \n    ',c=n["if"].call(e,(c=e&&e.options,null==c||c===!1?c:c.resetButton),{hash:{},inverse:_.noop,fn:_.program(14,f,l),data:l}),(c||0===c)&&(v+=c),v+="    \n  </div>\n\n</form>\n"},Hull.component({templates:["main","fields/text","fields/date","fields/number","fields/dropdown","fields/paragraph","fields/radio","fields/checkboxes","fields/website","fields/email"],require:["parsley","pikaday"],datasources:{form:":id",profile:function(){return this.loggedIn()?this.api("me/profile"):void 0},facebookProfile:function(){this.loggedIn()}},initialize:function(){this.injectLinkTag("parsley"),this.injectLinkTag("pikaday")},events:{"submit form":function(a){a.preventDefault();var e=this.sandbox.dom.getFormData(this.$(a.target));this.saveForm(e)}},actions:{reset:function(a){a&&a.preventDefault(),this.saveForm(!1)},edit:function(){this.sandbox.emit("form.edit",this.formName)}},saveForm:function(a){var e=this;this.$('[type="submit"]').attr("disabled",!0);var n={};n[this.formName]=a,this.api.put("me/profile",n).then(function(n){var t=n[e.formName];0!=a?e.emitFormEvent("saved",{data:t}):e.emitFormEvent("reset",{data:!1})},function(a){e.emitFormEvent("error",{errors:a})})},emitFormEvent:function(a,e){var n=e;n.eventName=a,n.formName=this.formName,n.cid=this.cid,this.sandbox.emit("form."+a,n)},listenToFormEvents:function(){this.listening||(this.sandbox.on("form.*",function(a){a&&a.formName&&(this.$('[type="submit"]').attr("disabled",!1),this.render())},this),this.listening=!0)},beforeRender:function(a){var e=a.formName=this.formName=this.normalizeFormName(a.form.uid),n=this,t=this.sandbox.util._,l=a.profile&&a.profile[e]||{};fields=a.form.extra.fields||[];var i=Math.round(1e6*Math.random());t.each(fields,function(a){a.input_id=["input",i,a.name].join("_"),a.value=l[a.name],a.value&&t.isArray(a.field_options.options)&&(t.each(a.field_options.options,function(e){e.selected=t.isArray(a.value)?t.include(a.value,e.label):e.label==a.value}),(t.isArray(a.value)&&t.include(a.value,"other")||"other"==a.value)&&(a.other_value=l[a.name+"_other_value"])),a.markup=n.renderTemplate("fields/"+a.field_type,a)}),a.fields=fields},afterRender:function(a){{var e=this,n=this.sandbox.util._;this.require("pikaday")}this.$("form").parsley(),window.Pikaday&&n.each(a.fields,function(a){if("date"===a.field_type){var n=a.field_options.format||"yyyy-mm-dd";new Pikaday({field:document.getElementById(a.input_id),format:n,moment:e.sandbox.util.moment})}}),this.listenToFormEvents()},normalizeFormName:function(a){return a.replace(/[^a-z0-9_\-]/gi,"_")},injectLinkTag:function(a){if(!this.linkTagInjected&&this.options.injectLinkTag!==!1){var e=document.createElement("link");e.href=this.options.baseUrl+"/"+a+".css",e.rel="stylesheet",document.getElementsByTagName("head")[0].appendChild(e),this.linkTagsInjected=!0}}});