this.Hull=this.Hull||{},this.Hull.templates=this.Hull.templates||{},this.Hull.templates._default=this.Hull.templates._default||{},Hull.templates._default["form/fields/checkboxes"]=function(a,e,l,n,t){function i(a,e,n){var t,i,s="";return s+="\n<div>\n  <label class='fb-option'>\n    <input type='checkbox' name=\""+c((t=n&&n.name,typeof t===d?t.apply(a):t))+'[]" value="',(i=l.label)?t=i.call(a,{hash:{},data:e}):(i=a&&a.label,t=typeof i===d?i.call(a,{hash:{},data:e}):i),s+=c(t)+'" ',t=l["if"].call(a,a&&a.selected,{hash:{},inverse:f.noop,fn:f.program(2,o,e),data:e}),(t||0===t)&&(s+=t),s+=" ",t=l["if"].call(a,a&&a.required,{hash:{},inverse:f.noop,fn:f.program(4,r,e),data:e}),(t||0===t)&&(s+=t),s+=" />\n    ",(i=l.label)?t=i.call(a,{hash:{},data:e}):(i=a&&a.label,t=typeof i===d?i.call(a,{hash:{},data:e}):i),s+=c(t)+"\n  </label>\n</div>\n"}function o(){return"checked"}function r(){return'data-parsley-maxcheck="1"'}function s(a,e){var n,t,i="";return i+="\n<div class='other-option'>\n  <label class='fb-option'>\n    <input type='checkbox' name=\"",(t=l.name)?n=t.call(a,{hash:{},data:e}):(t=a&&a.name,n=typeof t===d?t.call(a,{hash:{},data:e}):t),i+=c(n)+'[]" value="other" ',n=l["if"].call(a,a&&a.other_value,{hash:{},inverse:f.noop,fn:f.program(2,o,e),data:e}),(n||0===n)&&(i+=n),i+=" />\n    Other\n  </label>\n\n  <input type='text' name=\"",(t=l.name)?n=t.call(a,{hash:{},data:e}):(t=a&&a.name,n=typeof t===d?t.call(a,{hash:{},data:e}):t),i+=c(n)+'_other_value" value="',(t=l.other_value)?n=t.call(a,{hash:{},data:e}):(t=a&&a.other_value,n=typeof t===d?t.call(a,{hash:{},data:e}):t),i+=c(n)+'" />\n</div>\n'}this.compilerInfo=[4,">= 1.0.0"],l=this.merge(l,a.helpers),t=t||{};var h,p="",d="function",c=this.escapeExpression,f=this;return h=l.each.call(e,(h=e&&e.field_options,null==h||h===!1?h:h.options),{hash:{},inverse:f.noop,fn:f.programWithDepth(1,i,t,e),data:t}),(h||0===h)&&(p+=h),p+="\n\n",h=l["if"].call(e,(h=e&&e.field_options,null==h||h===!1?h:h.include_other_option),{hash:{},inverse:f.noop,fn:f.program(6,s,t),data:t}),(h||0===h)&&(p+=h),p},Hull.templates._default["form/fields/date"]=function(a,e,l,n,t){function i(){return"required"}this.compilerInfo=[4,">= 1.0.0"],l=this.merge(l,a.helpers),t=t||{};var o,r,s,h="",p="function",d=this.escapeExpression,c=this,f=l.blockHelperMissing;return h+='<input id="',(r=l.input_id)?o=r.call(e,{hash:{},data:t}):(r=e&&e.input_id,o=typeof r===p?r.call(e,{hash:{},data:t}):r),h+=d(o)+"\" type='text' name='",(r=l.name)?o=r.call(e,{hash:{},data:t}):(r=e&&e.name,o=typeof r===p?r.call(e,{hash:{},data:t}):r),h+=d(o)+"' class='form-control' \n  ",s={hash:{},inverse:c.noop,fn:c.program(1,i,t),data:t},(r=l.required)?o=r.call(e,s):(r=e&&e.required,o=typeof r===p?r.call(e,s):r),l.required||(o=f.call(e,o,{hash:{},inverse:c.noop,fn:c.program(1,i,t),data:t})),(o||0===o)&&(h+=o),h+=' \n  value="',(r=l.value)?o=r.call(e,{hash:{},data:t}):(r=e&&e.value,o=typeof r===p?r.call(e,{hash:{},data:t}):r),h+=d(o)+'"\n/>'},Hull.templates._default["form/fields/dropdown"]=function(a,e,l,n,t){function i(){return"\n    <option value=''></option>\n  "}function o(a,e){var n,t,i="";return i+='\n    <option value="',(t=l.label)?n=t.call(a,{hash:{},data:e}):(t=a&&a.label,n=typeof t===d?t.call(a,{hash:{},data:e}):t),i+=c(n)+'" ',n=l["if"].call(a,a&&a.selected,{hash:{},inverse:f.noop,fn:f.program(4,r,e),data:e}),(n||0===n)&&(i+=n),i+=">\n      ",(t=l.label)?n=t.call(a,{hash:{},data:e}):(t=a&&a.label,n=typeof t===d?t.call(a,{hash:{},data:e}):t),i+=c(n)+"\n    </option>\n  "}function r(){return"selected"}this.compilerInfo=[4,">= 1.0.0"],l=this.merge(l,a.helpers),t=t||{};var s,h,p="",d="function",c=this.escapeExpression,f=this;return p+='<select name="',(h=l.name)?s=h.call(e,{hash:{},data:t}):(h=e&&e.name,s=typeof h===d?h.call(e,{hash:{},data:t}):h),p+=c(s)+'" class="form-control">\n  ',s=l["if"].call(e,(s=e&&e.field_options,null==s||s===!1?s:s.include_blank_option),{hash:{},inverse:f.noop,fn:f.program(1,i,t),data:t}),(s||0===s)&&(p+=s),p+="\n  ",s=l.each.call(e,(s=e&&e.field_options,null==s||s===!1?s:s.options),{hash:{},inverse:f.noop,fn:f.program(3,o,t),data:t}),(s||0===s)&&(p+=s),p+="\n</select>\n"},Hull.templates._default["form/fields/email"]=function(a,e,l,n,t){function i(){return"required"}this.compilerInfo=[4,">= 1.0.0"],l=this.merge(l,a.helpers),t=t||{};var o,r,s,h="",p="function",d=this.escapeExpression,c=this,f=l.blockHelperMissing;return h+='<input  id="',(r=l.input_id)?o=r.call(e,{hash:{},data:t}):(r=e&&e.input_id,o=typeof r===p?r.call(e,{hash:{},data:t}):r),h+=d(o)+"\" type='email' name='",(r=l.name)?o=r.call(e,{hash:{},data:t}):(r=e&&e.name,o=typeof r===p?r.call(e,{hash:{},data:t}):r),h+=d(o)+'\' class="form-control"\n  ',s={hash:{},inverse:c.noop,fn:c.program(1,i,t),data:t},(r=l.required)?o=r.call(e,s):(r=e&&e.required,o=typeof r===p?r.call(e,s):r),l.required||(o=f.call(e,o,{hash:{},inverse:c.noop,fn:c.program(1,i,t),data:t})),(o||0===o)&&(h+=o),h+=' \n  data-parsley-trigger="change"\n  value="',(r=l.value)?o=r.call(e,{hash:{},data:t}):(r=e&&e.value,o=typeof r===p?r.call(e,{hash:{},data:t}):r),h+=d(o)+'" \n  placeholder="'+d((o=e&&e.field_options,o=null==o||o===!1?o:o.placeholder,typeof o===p?o.apply(e):o))+'"\n/>'},Hull.templates._default["form/fields/number"]=function(a,e,l,n,t){function i(a){var e,l="";return l+='min="'+f((e=a&&a.field_options,e=null==e||e===!1?e:e.min,typeof e===c?e.apply(a):e))+'"'}function o(a){var e,l="";return l+='max="'+f((e=a&&a.field_options,e=null==e||e===!1?e:e.max,typeof e===c?e.apply(a):e))+'"'}function r(){return'data-parsley-type="integer"'}function s(a){var e,l="";return l+='\n    <span class="add-on input-group-addon">'+f((e=a&&a.field_options,e=null==e||e===!1?e:e.units,typeof e===c?e.apply(a):e))+"</span>\n  "}this.compilerInfo=[4,">= 1.0.0"],l=this.merge(l,a.helpers),t=t||{};var h,p,d="",c="function",f=this.escapeExpression,u=this;return d+='<span class="input-group input-append">\n\n  <input type=\'text\' name="',(p=l.name)?h=p.call(e,{hash:{},data:t}):(p=e&&e.name,h=typeof p===c?p.call(e,{hash:{},data:t}):p),d+=f(h)+'" value="',(p=l.value)?h=p.call(e,{hash:{},data:t}):(p=e&&e.value,h=typeof p===c?p.call(e,{hash:{},data:t}):p),d+=f(h)+'"  class="form-control"\n    ',h=l["if"].call(e,(h=e&&e.field_options,null==h||h===!1?h:h.min),{hash:{},inverse:u.noop,fn:u.program(1,i,t),data:t}),(h||0===h)&&(d+=h),d+=" \n    ",h=l["if"].call(e,(h=e&&e.field_options,null==h||h===!1?h:h.max),{hash:{},inverse:u.noop,fn:u.program(3,o,t),data:t}),(h||0===h)&&(d+=h),d+=" \n    ",h=l["if"].call(e,(h=e&&e.field_options,null==h||h===!1?h:h.integer_only),{hash:{},inverse:u.noop,fn:u.program(5,r,t),data:t}),(h||0===h)&&(d+=h),d+='\n    data-parsley-trigger="change"\n    data-parsley-errors-container="#parsley-errors-',(p=l.input_id)?h=p.call(e,{hash:{},data:t}):(p=e&&e.input_id,h=typeof p===c?p.call(e,{hash:{},data:t}):p),d+=f(h)+'"\n  /> \n  ',h=l["if"].call(e,(h=e&&e.field_options,null==h||h===!1?h:h.units),{hash:{},inverse:u.noop,fn:u.program(7,s,t),data:t}),(h||0===h)&&(d+=h),d+='\n</span>\n\n<span id="parsley-errors-',(p=l.input_id)?h=p.call(e,{hash:{},data:t}):(p=e&&e.input_id,h=typeof p===c?p.call(e,{hash:{},data:t}):p),d+=f(h)+'"></span>\n'},Hull.templates._default["form/fields/paragraph"]=function(a,e,l,n,t){this.compilerInfo=[4,">= 1.0.0"],l=this.merge(l,a.helpers),t=t||{};var i,o,r="",s="function",h=this.escapeExpression;return r+='<textarea  id="',(o=l.input_id)?i=o.call(e,{hash:{},data:t}):(o=e&&e.input_id,i=typeof o===s?o.call(e,{hash:{},data:t}):o),r+=h(i)+'" name="',(o=l.name)?i=o.call(e,{hash:{},data:t}):(o=e&&e.name,i=typeof o===s?o.call(e,{hash:{},data:t}):o),r+=h(i)+'" class="form-control">',(o=l.value)?i=o.call(e,{hash:{},data:t}):(o=e&&e.value,i=typeof o===s?o.call(e,{hash:{},data:t}):o),r+=h(i)+"</textarea>"},Hull.templates._default["form/fields/radio"]=function(a,e,l,n,t){function i(a,e,n){var t,i,r="";return r+="\n<div>\n  <label class='fb-option'>\n    <input type='radio' name=\""+d((t=n&&n.name,typeof t===p?t.apply(a):t))+'" value="',(i=l.label)?t=i.call(a,{hash:{},data:e}):(i=a&&a.label,t=typeof i===p?i.call(a,{hash:{},data:e}):i),r+=d(t)+'" ',t=l["if"].call(a,a&&a.selected,{hash:{},inverse:c.noop,fn:c.program(2,o,e),data:e}),(t||0===t)&&(r+=t),r+=" />\n    ",(i=l.label)?t=i.call(a,{hash:{},data:e}):(i=a&&a.label,t=typeof i===p?i.call(a,{hash:{},data:e}):i),r+=d(t)+"\n  </label>\n</div>\n"}function o(){return"checked"}function r(a,e){var n,t,i,r="";return r+="\n<div class='other-option'>\n  <label class='fb-option'>\n    <input type='radio' name=\"",(t=l.name)?n=t.call(a,{hash:{},data:e}):(t=a&&a.name,n=typeof t===p?t.call(a,{hash:{},data:e}):t),r+=d(n)+'" value="other" ',t=l.ifEqual||a&&a.ifEqual,i={hash:{},inverse:c.noop,fn:c.program(2,o,e),data:e},n=t?t.call(a,a&&a.value,"other",i):f.call(a,"ifEqual",a&&a.value,"other",i),(n||0===n)&&(r+=n),r+=" />\n    Other\n  </label>\n\n  <input type='text' name=\"",(t=l.name)?n=t.call(a,{hash:{},data:e}):(t=a&&a.name,n=typeof t===p?t.call(a,{hash:{},data:e}):t),r+=d(n)+'_other_value" value="',(t=l.other_value)?n=t.call(a,{hash:{},data:e}):(t=a&&a.other_value,n=typeof t===p?t.call(a,{hash:{},data:e}):t),r+=d(n)+'" />\n</div>\n'}this.compilerInfo=[4,">= 1.0.0"],l=this.merge(l,a.helpers),t=t||{};var s,h="",p="function",d=this.escapeExpression,c=this,f=l.helperMissing;return s=l.each.call(e,(s=e&&e.field_options,null==s||s===!1?s:s.options),{hash:{},inverse:c.noop,fn:c.programWithDepth(1,i,t,e),data:t}),(s||0===s)&&(h+=s),h+="\n\n",s=l["if"].call(e,(s=e&&e.field_options,null==s||s===!1?s:s.include_other_option),{hash:{},inverse:c.noop,fn:c.program(4,r,t),data:t}),(s||0===s)&&(h+=s),h+="\n\n"},Hull.templates._default["form/fields/text"]=function(a,e,l,n,t){function i(){return"required"}function o(a){var e,l="";return l+='data-parsley-minlength="'+f((e=a&&a.field_options,e=null==e||e===!1?e:e.minlength,typeof e===c?e.apply(a):e))+'"'}function r(a){var e,l="";return l+='data-parsley-maxlength="'+f((e=a&&a.field_options,e=null==e||e===!1?e:e.maxlength,typeof e===c?e.apply(a):e))+'"'}this.compilerInfo=[4,">= 1.0.0"],l=this.merge(l,a.helpers),t=t||{};var s,h,p,d="",c="function",f=this.escapeExpression,u=this,m=l.blockHelperMissing;return d+='<input id="',(h=l.input_id)?s=h.call(e,{hash:{},data:t}):(h=e&&e.input_id,s=typeof h===c?h.call(e,{hash:{},data:t}):h),d+=f(s)+"\" type='text' name='",(h=l.name)?s=h.call(e,{hash:{},data:t}):(h=e&&e.name,s=typeof h===c?h.call(e,{hash:{},data:t}):h),d+=f(s)+"' class='form-control' \n  ",p={hash:{},inverse:u.noop,fn:u.program(1,i,t),data:t},(h=l.required)?s=h.call(e,p):(h=e&&e.required,s=typeof h===c?h.call(e,p):h),l.required||(s=m.call(e,s,{hash:{},inverse:u.noop,fn:u.program(1,i,t),data:t})),(s||0===s)&&(d+=s),d+=' \n  value="',(h=l.value)?s=h.call(e,{hash:{},data:t}):(h=e&&e.value,s=typeof h===c?h.call(e,{hash:{},data:t}):h),d+=f(s)+'"\n  ',s=l["if"].call(e,(s=e&&e.field_options,null==s||s===!1?s:s.minlength),{hash:{},inverse:u.noop,fn:u.program(3,o,t),data:t}),(s||0===s)&&(d+=s),d+=" \n  ",s=l["if"].call(e,(s=e&&e.field_options,null==s||s===!1?s:s.maxlength),{hash:{},inverse:u.noop,fn:u.program(5,r,t),data:t}),(s||0===s)&&(d+=s),d+=" \n/>"},Hull.templates._default["form/fields/website"]=function(a,e,l,n,t){function i(){return"required"}this.compilerInfo=[4,">= 1.0.0"],l=this.merge(l,a.helpers),t=t||{};var o,r,s,h="",p="function",d=this.escapeExpression,c=this,f=l.blockHelperMissing;return h+='<input  id="',(r=l.input_id)?o=r.call(e,{hash:{},data:t}):(r=e&&e.input_id,o=typeof r===p?r.call(e,{hash:{},data:t}):r),h+=d(o)+"\" type='url' name='",(r=l.name)?o=r.call(e,{hash:{},data:t}):(r=e&&e.name,o=typeof r===p?r.call(e,{hash:{},data:t}):r),h+=d(o)+'\' class="form-control" ',s={hash:{},inverse:c.noop,fn:c.program(1,i,t),data:t},(r=l.required)?o=r.call(e,s):(r=e&&e.required,o=typeof r===p?r.call(e,s):r),l.required||(o=f.call(e,o,{hash:{},inverse:c.noop,fn:c.program(1,i,t),data:t})),(o||0===o)&&(h+=o),h+=' value="',(r=l.value)?o=r.call(e,{hash:{},data:t}):(r=e&&e.value,o=typeof r===p?r.call(e,{hash:{},data:t}):r),h+=d(o)+'" placeholder="http://"/>'},Hull.templates._default["form/main"]=function(a,e,l,n,t){function i(a,e){var n,t,i="";return i+="\n  <h1>",(t=l.name)?n=t.call(a,{hash:{},data:e}):(t=a&&a.name,n=typeof t===m?t.call(a,{hash:{},data:e}):t),i+=v(n)+"</h1>\n  <p>",(t=l.description)?n=t.call(a,{hash:{},data:e}):(t=a&&a.description,n=typeof t===m?t.call(a,{hash:{},data:e}):t),i+=v(n)+"</p>\n  "}function o(a,e){var n,t,i,o="";return o+='\n    <div class="',t=l.ifEqual||a&&a.ifEqual,i={hash:{},inverse:y.program(6,s,e),fn:y.program(4,r,e),data:e},n=t?t.call(a,a&&a.field_type,"checkboxes",i):g.call(a,"ifEqual",a&&a.field_type,"checkboxes",i),(n||0===n)&&(o+=n),o+='" data-hull-field-name="',(t=l.name)?n=t.call(a,{hash:{},data:e}):(t=a&&a.name,n=typeof t===m?t.call(a,{hash:{},data:e}):t),o+=v(n)+'">\n      <label for="',(t=l.input_id)?n=t.call(a,{hash:{},data:e}):(t=a&&a.input_id,n=typeof t===m?t.call(a,{hash:{},data:e}):t),o+=v(n)+'">\n        ',(t=l.label)?n=t.call(a,{hash:{},data:e}):(t=a&&a.label,n=typeof t===m?t.call(a,{hash:{},data:e}):t),o+=v(n),n=l["if"].call(a,a&&a.required,{hash:{},inverse:y.noop,fn:y.program(8,h,e),data:e}),(n||0===n)&&(o+=n),o+="\n      </label>\n      ",(t=l.markup)?n=t.call(a,{hash:{},data:e}):(t=a&&a.markup,n=typeof t===m?t.call(a,{hash:{},data:e}):t),(n||0===n)&&(o+=n),o+="\n      ",n=l["if"].call(a,(n=a&&a.field_options,null==n||n===!1?n:n.description),{hash:{},inverse:y.noop,fn:y.program(10,p,e),data:e}),(n||0===n)&&(o+=n),o+="\n    </div>\n  "}function r(){return"checkkbox"}function s(){return"form-group"}function h(){return"*"}function p(a){var e,l="";return l+='\n      <p class="help-block">'+v((e=a&&a.field_options,e=null==e||e===!1?e:e.description,typeof e===m?e.apply(a):e))+"</p>\n      "}this.compilerInfo=[4,">= 1.0.0"],l=this.merge(l,a.helpers),t=t||{};var d,c,f,u="",m="function",v=this.escapeExpression,y=this,g=l.helperMissing,_=l.blockHelperMissing;return u+='<form role="form" data-hull-form-namespace="',(c=l.formNamespace)?d=c.call(e,{hash:{},data:t}):(c=e&&e.formNamespace,d=typeof c===m?c.call(e,{hash:{},data:t}):c),u+=v(d)+'">\n  ',f={hash:{},inverse:y.noop,fn:y.program(1,i,t),data:t},(c=l.form)?d=c.call(e,f):(c=e&&e.form,d=typeof c===m?c.call(e,f):c),l.form||(d=_.call(e,d,{hash:{},inverse:y.noop,fn:y.program(1,i,t),data:t})),(d||0===d)&&(u+=d),u+="\n\n  ",d=l.each.call(e,e&&e.fields,{hash:{},inverse:y.noop,fn:y.program(3,o,t),data:t}),(d||0===d)&&(u+=d),u+='\n  <button class="btn btn-primary btn-block" type="submit" >Save</button>\n</form>\n'},Hull.component({templates:["main","fields/text","fields/date","fields/number","fields/dropdown","fields/paragraph","fields/radio","fields/checkboxes","fields/website","fields/email"],require:["parsley","pikaday"],datasources:{form:":id",profile:function(){return this.loggedIn()?this.api("me/profile"):void 0}},initialize:function(){this.options.debug=/debug/.test(document.location.toString()),this.injectLinkTag("parsley"),this.injectLinkTag("pikaday")},events:{"submit form":function(a){a.preventDefault();var e=this.sandbox.dom.getFormData(this.$(a.target));this.saveForm(e)}},saveForm:function(a){var e=this;this.$('[type="submit"]').attr("disabled",!0);var l={};l[this.formNamespace]=a,this.api.put("me/profile",l,function(){e.render()})},beforeRender:function(a){var e=a.formNamespace=this.formNamespace=this.normalizeFormNamespace(a.form.uid),l=this,n=this.sandbox.util._,t=a.profile[e]||{};fields=a.form.extra.fields||[];var i=Math.round(1e6*Math.random());n.each(fields,function(a){a.input_id=["input",i,a.name].join("_"),a.value=t[a.name],a.value&&n.isArray(a.field_options.options)&&(n.each(a.field_options.options,function(e){e.selected=n.isArray(a.value)?n.include(a.value,e.label):e.label==a.value}),(n.isArray(a.value)&&n.include(a.value,"other")||"other"==a.value)&&(a.other_value=t[a.name+"_other_value"])),a.markup=l.renderTemplate("fields/"+a.field_type,a)}),a.fields=fields},afterRender:function(a){{var e=this,l=this.sandbox.util._;this.require("pikaday")}this.$("form").parsley(),window.Pikaday&&l.each(a.fields,function(a){if("date"===a.field_type){var l=a.field_options.format||"yyyy-mm-dd";new Pikaday({field:document.getElementById(a.input_id),format:l,moment:e.sandbox.util.moment})}})},normalizeFormNamespace:function(a){return a.replace(/[^a-z0-9_\-]/gi,"_")},injectLinkTag:function(a){if(!this.linkTagInjected&&this.options.injectLinkTag!==!1){var e=document.createElement("link");e.href=this.options.baseUrl+"/"+a+".css",e.rel="stylesheet",document.getElementsByTagName("head")[0].appendChild(e),this.linkTagsInjected=!0}}});