this.Hull=this.Hull||{},this.Hull.templates=this.Hull.templates||{},this.Hull.templates._default=this.Hull.templates._default||{},Hull.templates._default["form/fields/checkboxes"]=function(a,e,t,n,l){function i(a,e,n){var l,i,s="";return s+="\n<div>\n  <label class='fb-option'>\n    <input type='checkbox' name=\""+c((l=n&&n.name,typeof l===d?l.apply(a):l))+'[]" value="',(i=t.label)?l=i.call(a,{hash:{},data:e}):(i=a&&a.label,l=typeof i===d?i.call(a,{hash:{},data:e}):i),s+=c(l)+'" ',l=t["if"].call(a,a&&a.selected,{hash:{},inverse:f.noop,fn:f.program(2,o,e),data:e}),(l||0===l)&&(s+=l),s+=" ",l=t["if"].call(a,a&&a.required,{hash:{},inverse:f.noop,fn:f.program(4,r,e),data:e}),(l||0===l)&&(s+=l),s+=" />\n    ",(i=t.label)?l=i.call(a,{hash:{},data:e}):(i=a&&a.label,l=typeof i===d?i.call(a,{hash:{},data:e}):i),s+=c(l)+"\n  </label>\n</div>\n"}function o(){return"checked"}function r(){return'data-parsley-maxcheck="1"'}function s(a,e){var n,l,i="";return i+="\n<div class='other-option'>\n  <label class='fb-option'>\n    <input type='checkbox' name=\"",(l=t.name)?n=l.call(a,{hash:{},data:e}):(l=a&&a.name,n=typeof l===d?l.call(a,{hash:{},data:e}):l),i+=c(n)+'[]" value="other" ',n=t["if"].call(a,a&&a.other_value,{hash:{},inverse:f.noop,fn:f.program(2,o,e),data:e}),(n||0===n)&&(i+=n),i+=" />\n    Other\n  </label>\n\n  <input type='text' name=\"",(l=t.name)?n=l.call(a,{hash:{},data:e}):(l=a&&a.name,n=typeof l===d?l.call(a,{hash:{},data:e}):l),i+=c(n)+'_other_value" value="',(l=t.other_value)?n=l.call(a,{hash:{},data:e}):(l=a&&a.other_value,n=typeof l===d?l.call(a,{hash:{},data:e}):l),i+=c(n)+'" />\n</div>\n'}this.compilerInfo=[4,">= 1.0.0"],t=this.merge(t,a.helpers),l=l||{};var h,p="",d="function",c=this.escapeExpression,f=this;return h=t.each.call(e,(h=e&&e.field_options,null==h||h===!1?h:h.options),{hash:{},inverse:f.noop,fn:f.programWithDepth(1,i,l,e),data:l}),(h||0===h)&&(p+=h),p+="\n\n",h=t["if"].call(e,(h=e&&e.field_options,null==h||h===!1?h:h.include_other_option),{hash:{},inverse:f.noop,fn:f.program(6,s,l),data:l}),(h||0===h)&&(p+=h),p},Hull.templates._default["form/fields/date"]=function(a,e,t,n,l){function i(){return"required"}this.compilerInfo=[4,">= 1.0.0"],t=this.merge(t,a.helpers),l=l||{};var o,r,s,h="",p="function",d=this.escapeExpression,c=this,f=t.blockHelperMissing;return h+='<input id="',(r=t.input_id)?o=r.call(e,{hash:{},data:l}):(r=e&&e.input_id,o=typeof r===p?r.call(e,{hash:{},data:l}):r),h+=d(o)+"\" type='text' name='",(r=t.name)?o=r.call(e,{hash:{},data:l}):(r=e&&e.name,o=typeof r===p?r.call(e,{hash:{},data:l}):r),h+=d(o)+"' class='form-control' \n  ",s={hash:{},inverse:c.noop,fn:c.program(1,i,l),data:l},(r=t.required)?o=r.call(e,s):(r=e&&e.required,o=typeof r===p?r.call(e,s):r),t.required||(o=f.call(e,o,{hash:{},inverse:c.noop,fn:c.program(1,i,l),data:l})),(o||0===o)&&(h+=o),h+=' \n  value="',(r=t.value)?o=r.call(e,{hash:{},data:l}):(r=e&&e.value,o=typeof r===p?r.call(e,{hash:{},data:l}):r),h+=d(o)+'"\n/>'},Hull.templates._default["form/fields/dropdown"]=function(a,e,t,n,l){function i(){return"\n    <option value=''></option>\n  "}function o(a,e){var n,l,i="";return i+='\n    <option value="',(l=t.label)?n=l.call(a,{hash:{},data:e}):(l=a&&a.label,n=typeof l===d?l.call(a,{hash:{},data:e}):l),i+=c(n)+'" ',n=t["if"].call(a,a&&a.selected,{hash:{},inverse:f.noop,fn:f.program(4,r,e),data:e}),(n||0===n)&&(i+=n),i+=">\n      ",(l=t.label)?n=l.call(a,{hash:{},data:e}):(l=a&&a.label,n=typeof l===d?l.call(a,{hash:{},data:e}):l),i+=c(n)+"\n    </option>\n  "}function r(){return"selected"}this.compilerInfo=[4,">= 1.0.0"],t=this.merge(t,a.helpers),l=l||{};var s,h,p="",d="function",c=this.escapeExpression,f=this;return p+='<select name="',(h=t.name)?s=h.call(e,{hash:{},data:l}):(h=e&&e.name,s=typeof h===d?h.call(e,{hash:{},data:l}):h),p+=c(s)+'" class="form-control">\n  ',s=t["if"].call(e,(s=e&&e.field_options,null==s||s===!1?s:s.include_blank_option),{hash:{},inverse:f.noop,fn:f.program(1,i,l),data:l}),(s||0===s)&&(p+=s),p+="\n  ",s=t.each.call(e,(s=e&&e.field_options,null==s||s===!1?s:s.options),{hash:{},inverse:f.noop,fn:f.program(3,o,l),data:l}),(s||0===s)&&(p+=s),p+="\n</select>\n"},Hull.templates._default["form/fields/email"]=function(a,e,t,n,l){function i(){return"required"}this.compilerInfo=[4,">= 1.0.0"],t=this.merge(t,a.helpers),l=l||{};var o,r,s,h="",p="function",d=this.escapeExpression,c=this,f=t.blockHelperMissing;return h+='<input  id="',(r=t.input_id)?o=r.call(e,{hash:{},data:l}):(r=e&&e.input_id,o=typeof r===p?r.call(e,{hash:{},data:l}):r),h+=d(o)+"\" type='email' name='",(r=t.name)?o=r.call(e,{hash:{},data:l}):(r=e&&e.name,o=typeof r===p?r.call(e,{hash:{},data:l}):r),h+=d(o)+'\' class="form-control"\n  ',s={hash:{},inverse:c.noop,fn:c.program(1,i,l),data:l},(r=t.required)?o=r.call(e,s):(r=e&&e.required,o=typeof r===p?r.call(e,s):r),t.required||(o=f.call(e,o,{hash:{},inverse:c.noop,fn:c.program(1,i,l),data:l})),(o||0===o)&&(h+=o),h+=' \n  data-parsley-trigger="change"\n  value="',(r=t.value)?o=r.call(e,{hash:{},data:l}):(r=e&&e.value,o=typeof r===p?r.call(e,{hash:{},data:l}):r),h+=d(o)+'" \n  placeholder="'+d((o=e&&e.field_options,o=null==o||o===!1?o:o.placeholder,typeof o===p?o.apply(e):o))+'"\n/>'},Hull.templates._default["form/fields/number"]=function(a,e,t,n,l){function i(a){var e,t="";return t+='min="'+f((e=a&&a.field_options,e=null==e||e===!1?e:e.min,typeof e===c?e.apply(a):e))+'"'}function o(a){var e,t="";return t+='max="'+f((e=a&&a.field_options,e=null==e||e===!1?e:e.max,typeof e===c?e.apply(a):e))+'"'}function r(){return'data-parsley-type="integer"'}function s(a){var e,t="";return t+='\n    <span class="add-on input-group-addon">'+f((e=a&&a.field_options,e=null==e||e===!1?e:e.units,typeof e===c?e.apply(a):e))+"</span>\n  "}this.compilerInfo=[4,">= 1.0.0"],t=this.merge(t,a.helpers),l=l||{};var h,p,d="",c="function",f=this.escapeExpression,u=this;return d+='<span class="input-group input-append">\n\n  <input type=\'text\' name="',(p=t.name)?h=p.call(e,{hash:{},data:l}):(p=e&&e.name,h=typeof p===c?p.call(e,{hash:{},data:l}):p),d+=f(h)+'" value="',(p=t.value)?h=p.call(e,{hash:{},data:l}):(p=e&&e.value,h=typeof p===c?p.call(e,{hash:{},data:l}):p),d+=f(h)+'"  class="form-control"\n    ',h=t["if"].call(e,(h=e&&e.field_options,null==h||h===!1?h:h.min),{hash:{},inverse:u.noop,fn:u.program(1,i,l),data:l}),(h||0===h)&&(d+=h),d+=" \n    ",h=t["if"].call(e,(h=e&&e.field_options,null==h||h===!1?h:h.max),{hash:{},inverse:u.noop,fn:u.program(3,o,l),data:l}),(h||0===h)&&(d+=h),d+=" \n    ",h=t["if"].call(e,(h=e&&e.field_options,null==h||h===!1?h:h.integer_only),{hash:{},inverse:u.noop,fn:u.program(5,r,l),data:l}),(h||0===h)&&(d+=h),d+='\n    data-parsley-trigger="change"\n    data-parsley-errors-container="#parsley-errors-',(p=t.input_id)?h=p.call(e,{hash:{},data:l}):(p=e&&e.input_id,h=typeof p===c?p.call(e,{hash:{},data:l}):p),d+=f(h)+'"\n  /> \n  ',h=t["if"].call(e,(h=e&&e.field_options,null==h||h===!1?h:h.units),{hash:{},inverse:u.noop,fn:u.program(7,s,l),data:l}),(h||0===h)&&(d+=h),d+='\n</span>\n\n<span id="parsley-errors-',(p=t.input_id)?h=p.call(e,{hash:{},data:l}):(p=e&&e.input_id,h=typeof p===c?p.call(e,{hash:{},data:l}):p),d+=f(h)+'"></span>\n'},Hull.templates._default["form/fields/paragraph"]=function(a,e,t,n,l){this.compilerInfo=[4,">= 1.0.0"],t=this.merge(t,a.helpers),l=l||{};var i,o,r="",s="function",h=this.escapeExpression;return r+='<textarea  id="',(o=t.input_id)?i=o.call(e,{hash:{},data:l}):(o=e&&e.input_id,i=typeof o===s?o.call(e,{hash:{},data:l}):o),r+=h(i)+'" name="',(o=t.name)?i=o.call(e,{hash:{},data:l}):(o=e&&e.name,i=typeof o===s?o.call(e,{hash:{},data:l}):o),r+=h(i)+'" class="form-control">',(o=t.value)?i=o.call(e,{hash:{},data:l}):(o=e&&e.value,i=typeof o===s?o.call(e,{hash:{},data:l}):o),r+=h(i)+"</textarea>"},Hull.templates._default["form/fields/radio"]=function(a,e,t,n,l){function i(a,e,n){var l,i,r="";return r+="\n<div>\n  <label class='fb-option'>\n    <input type='radio' name=\""+d((l=n&&n.name,typeof l===p?l.apply(a):l))+'" value="',(i=t.label)?l=i.call(a,{hash:{},data:e}):(i=a&&a.label,l=typeof i===p?i.call(a,{hash:{},data:e}):i),r+=d(l)+'" ',l=t["if"].call(a,a&&a.selected,{hash:{},inverse:c.noop,fn:c.program(2,o,e),data:e}),(l||0===l)&&(r+=l),r+=" />\n    ",(i=t.label)?l=i.call(a,{hash:{},data:e}):(i=a&&a.label,l=typeof i===p?i.call(a,{hash:{},data:e}):i),r+=d(l)+"\n  </label>\n</div>\n"}function o(){return"checked"}function r(a,e){var n,l,i,r="";return r+="\n<div class='other-option'>\n  <label class='fb-option'>\n    <input type='radio' name=\"",(l=t.name)?n=l.call(a,{hash:{},data:e}):(l=a&&a.name,n=typeof l===p?l.call(a,{hash:{},data:e}):l),r+=d(n)+'" value="other" ',l=t.ifEqual||a&&a.ifEqual,i={hash:{},inverse:c.noop,fn:c.program(2,o,e),data:e},n=l?l.call(a,a&&a.value,"other",i):f.call(a,"ifEqual",a&&a.value,"other",i),(n||0===n)&&(r+=n),r+=" />\n    Other\n  </label>\n\n  <input type='text' name=\"",(l=t.name)?n=l.call(a,{hash:{},data:e}):(l=a&&a.name,n=typeof l===p?l.call(a,{hash:{},data:e}):l),r+=d(n)+'_other_value" value="',(l=t.other_value)?n=l.call(a,{hash:{},data:e}):(l=a&&a.other_value,n=typeof l===p?l.call(a,{hash:{},data:e}):l),r+=d(n)+'" />\n</div>\n'}this.compilerInfo=[4,">= 1.0.0"],t=this.merge(t,a.helpers),l=l||{};var s,h="",p="function",d=this.escapeExpression,c=this,f=t.helperMissing;return s=t.each.call(e,(s=e&&e.field_options,null==s||s===!1?s:s.options),{hash:{},inverse:c.noop,fn:c.programWithDepth(1,i,l,e),data:l}),(s||0===s)&&(h+=s),h+="\n\n",s=t["if"].call(e,(s=e&&e.field_options,null==s||s===!1?s:s.include_other_option),{hash:{},inverse:c.noop,fn:c.program(4,r,l),data:l}),(s||0===s)&&(h+=s),h+="\n\n"},Hull.templates._default["form/fields/text"]=function(a,e,t,n,l){function i(){return"required"}function o(a){var e,t="";return t+='data-parsley-minlength="'+f((e=a&&a.field_options,e=null==e||e===!1?e:e.minlength,typeof e===c?e.apply(a):e))+'"'}function r(a){var e,t="";return t+='data-parsley-maxlength="'+f((e=a&&a.field_options,e=null==e||e===!1?e:e.maxlength,typeof e===c?e.apply(a):e))+'"'}this.compilerInfo=[4,">= 1.0.0"],t=this.merge(t,a.helpers),l=l||{};var s,h,p,d="",c="function",f=this.escapeExpression,u=this,m=t.blockHelperMissing;return d+='<input id="',(h=t.input_id)?s=h.call(e,{hash:{},data:l}):(h=e&&e.input_id,s=typeof h===c?h.call(e,{hash:{},data:l}):h),d+=f(s)+"\" type='text' name='",(h=t.name)?s=h.call(e,{hash:{},data:l}):(h=e&&e.name,s=typeof h===c?h.call(e,{hash:{},data:l}):h),d+=f(s)+"' class='form-control' \n  ",p={hash:{},inverse:u.noop,fn:u.program(1,i,l),data:l},(h=t.required)?s=h.call(e,p):(h=e&&e.required,s=typeof h===c?h.call(e,p):h),t.required||(s=m.call(e,s,{hash:{},inverse:u.noop,fn:u.program(1,i,l),data:l})),(s||0===s)&&(d+=s),d+=' \n  value="',(h=t.value)?s=h.call(e,{hash:{},data:l}):(h=e&&e.value,s=typeof h===c?h.call(e,{hash:{},data:l}):h),d+=f(s)+'"\n  ',s=t["if"].call(e,(s=e&&e.field_options,null==s||s===!1?s:s.minlength),{hash:{},inverse:u.noop,fn:u.program(3,o,l),data:l}),(s||0===s)&&(d+=s),d+=" \n  ",s=t["if"].call(e,(s=e&&e.field_options,null==s||s===!1?s:s.maxlength),{hash:{},inverse:u.noop,fn:u.program(5,r,l),data:l}),(s||0===s)&&(d+=s),d+=" \n/>"},Hull.templates._default["form/fields/website"]=function(a,e,t,n,l){function i(){return"required"}this.compilerInfo=[4,">= 1.0.0"],t=this.merge(t,a.helpers),l=l||{};var o,r,s,h="",p="function",d=this.escapeExpression,c=this,f=t.blockHelperMissing;return h+='<input  id="',(r=t.input_id)?o=r.call(e,{hash:{},data:l}):(r=e&&e.input_id,o=typeof r===p?r.call(e,{hash:{},data:l}):r),h+=d(o)+"\" type='url' name='",(r=t.name)?o=r.call(e,{hash:{},data:l}):(r=e&&e.name,o=typeof r===p?r.call(e,{hash:{},data:l}):r),h+=d(o)+'\' class="form-control" ',s={hash:{},inverse:c.noop,fn:c.program(1,i,l),data:l},(r=t.required)?o=r.call(e,s):(r=e&&e.required,o=typeof r===p?r.call(e,s):r),t.required||(o=f.call(e,o,{hash:{},inverse:c.noop,fn:c.program(1,i,l),data:l})),(o||0===o)&&(h+=o),h+=' value="',(r=t.value)?o=r.call(e,{hash:{},data:l}):(r=e&&e.value,o=typeof r===p?r.call(e,{hash:{},data:l}):r),h+=d(o)+'" placeholder="http://"/>'},Hull.templates._default["form/main"]=function(a,e,t,n,l){function i(a,e){var n,l,i="";return i+="\n  <h1>",(l=t.name)?n=l.call(a,{hash:{},data:e}):(l=a&&a.name,n=typeof l===v?l.call(a,{hash:{},data:e}):l),i+=y(n)+"</h1>\n  <p>",(l=t.description)?n=l.call(a,{hash:{},data:e}):(l=a&&a.description,n=typeof l===v?l.call(a,{hash:{},data:e}):l),i+=y(n)+"</p>\n  "}function o(a,e){var n,l,i,o="";return o+='\n    <div class="',l=t.ifEqual||a&&a.ifEqual,i={hash:{},inverse:g.program(6,s,e),fn:g.program(4,r,e),data:e},n=l?l.call(a,a&&a.field_type,"checkboxes",i):_.call(a,"ifEqual",a&&a.field_type,"checkboxes",i),(n||0===n)&&(o+=n),o+='" data-hull-field-name="',(l=t.name)?n=l.call(a,{hash:{},data:e}):(l=a&&a.name,n=typeof l===v?l.call(a,{hash:{},data:e}):l),o+=y(n)+'">\n      <label for="',(l=t.input_id)?n=l.call(a,{hash:{},data:e}):(l=a&&a.input_id,n=typeof l===v?l.call(a,{hash:{},data:e}):l),o+=y(n)+'">\n        ',(l=t.label)?n=l.call(a,{hash:{},data:e}):(l=a&&a.label,n=typeof l===v?l.call(a,{hash:{},data:e}):l),o+=y(n),n=t["if"].call(a,a&&a.required,{hash:{},inverse:g.noop,fn:g.program(8,h,e),data:e}),(n||0===n)&&(o+=n),o+="\n      </label>\n      ",(l=t.markup)?n=l.call(a,{hash:{},data:e}):(l=a&&a.markup,n=typeof l===v?l.call(a,{hash:{},data:e}):l),(n||0===n)&&(o+=n),o+="\n      ",n=t["if"].call(a,(n=a&&a.field_options,null==n||n===!1?n:n.description),{hash:{},inverse:g.noop,fn:g.program(10,p,e),data:e}),(n||0===n)&&(o+=n),o+="\n    </div>\n  "}function r(){return"checkkbox"}function s(){return"form-group"}function h(){return"*"}function p(a){var e,t="";return t+='\n      <p class="help-block">'+y((e=a&&a.field_options,e=null==e||e===!1?e:e.description,typeof e===v?e.apply(a):e))+"</p>\n      "}function d(){return'\n  <button class="btn btn-danger btn-block" data-hull-action="reset">Reset</button>\n  '}this.compilerInfo=[4,">= 1.0.0"],t=this.merge(t,a.helpers),l=l||{};var c,f,u,m="",v="function",y=this.escapeExpression,g=this,_=t.helperMissing,b=t.blockHelperMissing;return m+='<form role="form" data-hull-form-namespace="',(f=t.formNamespace)?c=f.call(e,{hash:{},data:l}):(f=e&&e.formNamespace,c=typeof f===v?f.call(e,{hash:{},data:l}):f),m+=y(c)+'">\n  ',u={hash:{},inverse:g.noop,fn:g.program(1,i,l),data:l},(f=t.form)?c=f.call(e,u):(f=e&&e.form,c=typeof f===v?f.call(e,u):f),t.form||(c=b.call(e,c,{hash:{},inverse:g.noop,fn:g.program(1,i,l),data:l})),(c||0===c)&&(m+=c),m+="\n\n  ",c=t.each.call(e,e&&e.fields,{hash:{},inverse:g.noop,fn:g.program(3,o,l),data:l}),(c||0===c)&&(m+=c),m+='\n  <button class="btn btn-primary btn-block" type="submit" >Save</button>\n  ',c=t["if"].call(e,(c=e&&e.options,null==c||c===!1?c:c.resetButton),{hash:{},inverse:g.noop,fn:g.program(12,d,l),data:l}),(c||0===c)&&(m+=c),m+="\n</form>\n"},Hull.component({templates:["main","fields/text","fields/date","fields/number","fields/dropdown","fields/paragraph","fields/radio","fields/checkboxes","fields/website","fields/email"],require:["parsley","pikaday"],datasources:{form:":id",profile:function(){return this.loggedIn()?this.api("me/profile"):void 0}},initialize:function(){this.options.debug=/debug/.test(document.location.toString()),this.injectLinkTag("parsley"),this.injectLinkTag("pikaday")},events:{"submit form":function(a){a.preventDefault();var e=this.sandbox.dom.getFormData(this.$(a.target));this.saveForm(e)}},actions:{reset:function(a){a&&a.preventDefault(),this.saveForm(!1)}},saveForm:function(a){var e=this;this.$('[type="submit"]').attr("disabled",!0);var t={};t[this.formName]=a,this.api.put("me/profile",t).then(function(t){var n=t[e.formName];0!=a?e.emitFormEvent("saved",{data:n}):e.emitFormEvent("reset",{data:!1})},function(a){e.emitFormEvent("error",{errors:a})})},emitFormEvent:function(a,e){var t=e;t.eventName=a,t.formName=this.formName,t.cid=this.cid,this.sandbox.emit("form."+a,t)},listenToFormEvents:function(){this.listening||(console.warn("Listeing now... ",this.cid),this.sandbox.on("form.*",function(a){a&&a.formName?(this.$('[type="submit"]').attr("disabled",!1),this.render()):console.warn("... not for me.... ",a)},this),this.listening=!0)},beforeRender:function(a){var e=a.formName=this.formName=this.normalizeFormName(a.form.uid),t=this,n=this.sandbox.util._,l=a.profile&&a.profile[e]||{};fields=a.form.extra.fields||[];var i=Math.round(1e6*Math.random());n.each(fields,function(a){a.input_id=["input",i,a.name].join("_"),a.value=l[a.name],a.value&&n.isArray(a.field_options.options)&&(n.each(a.field_options.options,function(e){e.selected=n.isArray(a.value)?n.include(a.value,e.label):e.label==a.value}),(n.isArray(a.value)&&n.include(a.value,"other")||"other"==a.value)&&(a.other_value=l[a.name+"_other_value"])),a.markup=t.renderTemplate("fields/"+a.field_type,a)}),a.fields=fields},afterRender:function(a){{var e=this,t=this.sandbox.util._;this.require("pikaday")}this.$("form").parsley(),window.Pikaday&&t.each(a.fields,function(a){if("date"===a.field_type){var t=a.field_options.format||"yyyy-mm-dd";new Pikaday({field:document.getElementById(a.input_id),format:t,moment:e.sandbox.util.moment})}}),this.listenToFormEvents()},normalizeFormName:function(a){return a.replace(/[^a-z0-9_\-]/gi,"_")},injectLinkTag:function(a){if(!this.linkTagInjected&&this.options.injectLinkTag!==!1){var e=document.createElement("link");e.href=this.options.baseUrl+"/"+a+".css",e.rel="stylesheet",document.getElementsByTagName("head")[0].appendChild(e),this.linkTagsInjected=!0}}});